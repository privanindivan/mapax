(()=>{"use strict";var e={3183:(e,t,n)=>{n(3792),n(3362),n(9085),n(9391);var a=n(3751),o=(n(2010),n(641)),r=n(33),l={class:"app"},i={key:0,class:"ranking-overlay"},u={class:"ranking-content"},c={class:"ranking-list"},s={class:"rank-number"},d={class:"rank-details"},p={class:"votes"},v=["onClick"];function m(e,t,n,a,m,f){var g=(0,o.g2)("UserMenu"),h=(0,o.g2)("AuthModal"),k=(0,o.g2)("MapView"),b=(0,o.g2)("PlaceDetailsDialog");return(0,o.uX)(),(0,o.CE)("div",l,[(0,o.bF)(g,{user:a.user,onLogin:t[0]||(t[0]=function(e){return a.showAuthModal=!0}),onLogout:a.handleLogout},null,8,["user","onLogout"]),(0,o.Lk)("button",{onClick:t[1]||(t[1]=function(){return a.toggleRanking&&a.toggleRanking.apply(a,arguments)}),class:(0,r.C4)(["ranking-button",{active:a.showRanking}])}," ‚¨ÜÔ∏è Rankings ",2),a.showRanking?((0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("div",u,[(0,o.Lk)("button",{onClick:t[2]||(t[2]=function(e){return a.showRanking=!1}),class:"close-button"},"√ó"),(0,o.Lk)("div",c,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.sortedPlaces,(function(e){return(0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"ranking-item"},[(0,o.Lk)("span",s,(0,r.v_)(e.rank),1),(0,o.Lk)("div",d,[(0,o.Lk)("h3",null,(0,r.v_)(e.name),1),(0,o.Lk)("p",p,(0,r.v_)(e.votes||0)+" votes",1)]),(0,o.Lk)("button",{onClick:function(t){return a.selectAndCloseRanking(e.id)},class:"view-button"},"View",8,v)])})),128))])])])):(0,o.Q3)("",!0),a.showAuthModal?((0,o.uX)(),(0,o.Wv)(h,{key:1,onClose:t[3]||(t[3]=function(e){return a.showAuthModal=!1}),onAuthSuccess:a.handleAuthSuccess},null,8,["onAuthSuccess"])):(0,o.Q3)("",!0),(0,o.bF)(k,{markers:a.markers,"is-adding-mode":a.isAddingMode,onMarkerClick:a.selectMarker,onMapClick:a.handleMapClick,onToggleAddMode:a.toggleAddMode,onLocationError:a.handleLocationError},null,8,["markers","is-adding-mode","onMarkerClick","onMapClick","onToggleAddMode","onLocationError"]),a.selectedMarker?((0,o.uX)(),(0,o.Wv)(b,{key:2,place:a.selectedMarker,"can-delete":a.canDeletePlace,onClose:a.closeDialog,onUpdate:a.updatePlace,onDelete:a.handleDelete},null,8,["place","can-delete","onClose","onUpdate","onDelete"])):(0,o.Q3)("",!0)])}var f=n(4048),g=n(388),h=n(9201),k=n(5492),b=(n(2675),n(9463),n(2008),n(113),n(8980),n(2062),n(4114),n(6910),n(1688),n(3288),n(6099),n(8992),n(4520),n(2577),n(1454),n(953)),y={class:"map-wrapper"};function w(e,t,n,a,r,l){var i=(0,o.g2)("MapControls");return(0,o.uX)(),(0,o.CE)("div",y,[t[0]||(t[0]=(0,o.Lk)("h2",{class:"map-heading"},"MAPA",-1)),t[1]||(t[1]=(0,o.Lk)("div",{id:"map",class:"map"},null,-1)),(0,o.bF)(i,{onGetLocation:a.getCurrentLocation,onToggleAddMode:a.toggleAddMode,"is-adding-mode":n.isAddingMode},null,8,["onGetLocation","onToggleAddMode","is-adding-mode"])])}n(8706),n(1629),n(3949),n(3500);var A=n(3481),C=n.n(A),L={class:"map-controls"};function E(e,t,n,a,l,i){return(0,o.uX)(),(0,o.CE)("div",L,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=function(t){return e.$emit("get-location")}),class:"control-button location-button"},t[2]||(t[2]=[(0,o.Lk)("span",{class:"button-icon"},"üìç",-1)])),(0,o.Lk)("button",{onClick:t[1]||(t[1]=function(t){return e.$emit("toggle-add-mode")}),class:(0,r.C4)(["control-button","add-button",{"add-button-active":n.isAddingMode}])},t[3]||(t[3]=[(0,o.Lk)("span",{class:"plus-icon"},"+",-1)]),2)])}const x={name:"MapControls",props:{isAddingMode:{type:Boolean,default:!1}},emits:["get-location","toggle-add-mode"]};var I=n(6262);const M=(0,I.A)(x,[["render",E],["__scopeId","data-v-528d4547"]]),_=M;var S={southwest:[4.566667,116.7],northeast:[21.120556,126.537778]},D=[14.293054,121.005381],O={office:C().divIcon({html:"üèõÔ∏è",className:"custom-marker",iconSize:[30,30]}),restaurant:C().divIcon({html:"ü•£",className:"custom-marker",iconSize:[30,30]}),shipping:C().divIcon({html:"üì¶",className:"custom-marker",iconSize:[30,30]}),laundry:C().divIcon({html:"üëï",className:"custom-marker",iconSize:[30,30]}),church:C().divIcon({html:"‚õ™",className:"custom-marker",iconSize:[30,30]}),school:C().divIcon({html:"üè´",className:"custom-marker",iconSize:[30,30]}),store:C().divIcon({html:"üè™",className:"custom-marker",iconSize:[30,30]}),barber:C().divIcon({html:"‚úÇÔ∏è",className:"custom-marker",iconSize:[30,30]}),default:C().divIcon({html:"üìç",className:"custom-marker",iconSize:[30,30]})};const P={name:"MapView",components:{MapControls:_},props:{markers:{type:Array,default:function(){return[]}},isAddingMode:{type:Boolean,default:!1}},emits:["marker-click","map-click","toggle-add-mode","location-error"],setup:function(e,t){var n=t.emit,a=(0,b.KR)(null),r=(0,b.KR)(null),l=(0,b.KR)(null),i=(0,b.KR)(null),u=function(e){var t=e.detail;t&&n("marker-click",t)};(0,o.sV)((function(){a.value=C().map("map",{center:D,zoom:16,minZoom:15,maxZoom:19,zoomControl:!1,maxBounds:C().latLngBounds(S.southwest,S.northeast),maxBoundsViscosity:1}),C().tileLayer("https://tile.thunderforest.com/neighbourhood/{z}/{x}/{y}.png?apikey=375c923e2b8447249e6774bc2d2f3fa2",{attribution:"",minZoom:15,maxZoom:19}).addTo(a.value),r.value=C().layerGroup().addTo(a.value),document.addEventListener("showDetails",u),a.value.on("click",(function(t){e.isAddingMode&&(n("map-click",t.latlng),i.value&&r.value.removeLayer(i.value),i.value=C().circleMarker(t.latlng,{radius:8,fillColor:"#FF4081",color:"#fff",weight:2,opacity:1,fillOpacity:.8}).addTo(r.value))}))})),(0,o.wB)((function(){return e.markers}),(function(e){a.value&&r.value&&(r.value.clearLayers(),e.forEach((function(e){var t=O[e.type]||O["default"],o=C().marker([e.lat,e.lng],{icon:t}).addTo(r.value).on("click",(function(){a.value.setView([e.lat,e.lng],18,{animate:!0,duration:1}),n("marker-click",e.id)}));o.bindPopup('\n          <div class="marker-popup">\n            <h3>'.concat(e.name||"Unnamed Place","</h3>\n            <button onclick=\"document.dispatchEvent(new CustomEvent('showDetails', {detail: '").concat(e.id,"'}))\">\n              View Details\n            </button>\n          </div>\n        "))})))}),{deep:!0});var c=function(){a.value&&(navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){var t=e.coords,n=t.latitude,o=t.longitude;l.value&&a.value.removeLayer(l.value),l.value=C().circleMarker([n,o],{radius:8,fillColor:"#4CAF50",color:"#fff",weight:2,opacity:1,fillOpacity:.8}).addTo(r.value),a.value.setView([n,o],16,{animate:!0,duration:1})}),(function(){n("location-error","Unable to retrieve your location")})):n("location-error","Geolocation is not supported by your browser"))},s=function(){n("toggle-add-mode",!e.isAddingMode),i.value&&r.value&&(r.value.removeLayer(i.value),i.value=null)};return(0,o.xo)((function(){document.removeEventListener("showDetails",u),a.value&&a.value.remove()})),{getCurrentLocation:c,toggleAddMode:s}}},R=(0,I.A)(P,[["render",w],["__scopeId","data-v-b321129e"]]),X=R;var V={class:"dialog-overlay"},j={class:"dialog-content"},T={class:"dialog-header"},U={key:1,class:"place-name"},F={class:"images-section"},K={key:0,class:"image-grid"},N=["onClick"],z=["src","alt"],G=["onClick"],B={key:1,class:"upload-section"},J={class:"voting-section"},Q=["disabled"],Z={class:"vote-count"},W=["disabled"],$={class:"tabs"},q={key:1,class:"tab-content"},Y={class:"description-section"},H={key:1,class:"description-text"},ee={class:"metadata-section"},te={class:"last-edited"},ne={key:2,class:"tab-content"},ae={class:"comments-section"},oe={class:"comments-list"},re={class:"comment-text"},le={class:"comment-date"},ie=["src"];function ue(e,t,n,l,i,u){var c,s,d,p,v,m,f,g,h,k,b;return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",V,[(0,o.Lk)("div",j,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=function(t){return e.$emit("close")}),class:"close-button"},"√ó"),l.canDelete?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t[1]||(t[1]=function(){return l.handleDelete&&l.handleDelete.apply(l,arguments)}),class:"delete-button"}," Delete ")):(0,o.Q3)("",!0),(0,o.Lk)("div",T,[l.isEditing?(0,o.bo)(((0,o.uX)(),(0,o.CE)("input",{key:0,"onUpdate:modelValue":t[2]||(t[2]=function(e){return l.editedPlace.name=e}),class:"name-input",onKeyup:t[3]||(t[3]=(0,a.jR)((function(){return l.toggleEdit&&l.toggleEdit.apply(l,arguments)}),["enter"]))},null,544)),[[a.Jo,l.editedPlace.name]]):((0,o.uX)(),(0,o.CE)("h2",U,(0,r.v_)((null===(c=n.place)||void 0===c?void 0:c.name)||"New Place"),1))]),(0,o.Lk)("div",F,[(0,o.Lk)("h3",null,"("+(0,r.v_)((null===(s=n.place)||void 0===s||null===(s=s.images)||void 0===s?void 0:s.length)||0)+"/3)",1),((null===(d=n.place)||void 0===d||null===(d=d.images)||void 0===d?void 0:d.length)||0)>0?((0,o.uX)(),(0,o.CE)("div",K,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((null===(p=n.place)||void 0===p?void 0:p.images)||[],(function(e,t){return(0,o.uX)(),(0,o.CE)("div",{key:t,class:"image-container",onClick:function(t){return l.showFullscreen(e)}},[(0,o.Lk)("img",{src:e,alt:"Image "+(t+1),class:"place-image"},null,8,z),(0,o.Lk)("button",{onClick:(0,a.D$)((function(e){return l.removeImage(t)}),["stop"]),class:"remove-image"},"√ó",8,G)],8,N)})),128))])):(0,o.Q3)("",!0),((null===(v=n.place)||void 0===v||null===(v=v.images)||void 0===v?void 0:v.length)||0)<3?((0,o.uX)(),(0,o.CE)("div",B,[(0,o.Lk)("input",{type:"file",accept:"image/*",onChange:t[4]||(t[4]=function(){return l.handleImageUpload&&l.handleImageUpload.apply(l,arguments)}),ref:"fileInput",class:"hidden"},null,544),(0,o.Lk)("button",{onClick:t[5]||(t[5]=function(t){return e.$refs.fileInput.click()}),class:"add-image-button"}," Add Image ")])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",J,[(0,o.Lk)("button",{onClick:t[6]||(t[6]=function(e){return l.handleVote("down")}),class:(0,r.C4)(["vote-button",{active:"down"===l.hasVoted}]),disabled:null===(m=n.place)||void 0===m?void 0:m.hasVoted}," ‚ñº ",10,Q),(0,o.Lk)("span",Z,(0,r.v_)((null===(f=n.place)||void 0===f?void 0:f.votes)||0),1),(0,o.Lk)("button",{onClick:t[7]||(t[7]=function(e){return l.handleVote("up")}),class:(0,r.C4)(["vote-button",{active:"up"===l.hasVoted}]),disabled:null===(g=n.place)||void 0===g?void 0:g.hasVoted}," ‚ñ≤ ",10,W)]),(0,o.Lk)("div",$,[(0,o.Lk)("button",{class:(0,r.C4)(["tab-button",{active:"details"===l.activeTab}]),onClick:t[8]||(t[8]=function(e){return l.activeTab="details"})}," Details ",2),(0,o.Lk)("button",{class:(0,r.C4)(["tab-button",{active:"comments"===l.activeTab}]),onClick:t[9]||(t[9]=function(e){return l.activeTab="comments"})}," Comments ",2)]),"details"===l.activeTab?((0,o.uX)(),(0,o.CE)("div",q,[(0,o.Lk)("div",Y,[l.isEditing?(0,o.bo)(((0,o.uX)(),(0,o.CE)("textarea",{key:0,"onUpdate:modelValue":t[10]||(t[10]=function(e){return l.editedPlace.description=e}),class:"description-input",rows:"4",placeholder:"Add description here..."},null,512)),[[a.Jo,l.editedPlace.description]]):((0,o.uX)(),(0,o.CE)("p",H,(0,r.v_)((null===(h=n.place)||void 0===h?void 0:h.description)||"Add description here..."),1)),(0,o.Lk)("button",{onClick:t[11]||(t[11]=function(){return l.toggleEdit&&l.toggleEdit.apply(l,arguments)}),class:"edit-button"},(0,r.v_)(l.isEditing?"Save":"Edit"),1)]),(0,o.Lk)("div",ee,[(0,o.Lk)("p",te,(0,r.v_)(l.formatDate(null===(k=n.place)||void 0===k?void 0:k.lastEdited)),1),t[15]||(t[15]=(0,o.Lk)("p",{class:"contact-info"},"pm for issue ronlim016@gmail.com",-1))])])):(0,o.Q3)("",!0),"comments"===l.activeTab?((0,o.uX)(),(0,o.CE)("div",ne,[(0,o.Lk)("div",ae,[(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[12]||(t[12]=function(e){return l.newComment=e}),class:"comment-input",placeholder:"Add a comment...",rows:"3"},null,512),[[a.Jo,l.newComment]]),(0,o.Lk)("button",{onClick:t[13]||(t[13]=function(){return l.addComment&&l.addComment.apply(l,arguments)}),class:"add-comment-button"}," Add Comment "),(0,o.Lk)("div",oe,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((null===(b=n.place)||void 0===b?void 0:b.comments)||[],(function(e){return(0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"comment"},[(0,o.Lk)("p",re,(0,r.v_)(e.text),1),(0,o.Lk)("p",le,(0,r.v_)(e.date),1)])})),128))])])])):(0,o.Q3)("",!0)])]),l.fullscreenImage?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"fullscreen-overlay",onClick:t[14]||(t[14]=function(){return l.closeFullscreen&&l.closeFullscreen.apply(l,arguments)})},[(0,o.Lk)("img",{src:l.fullscreenImage,alt:"Fullscreen view",class:"fullscreen-image"},null,8,ie)])):(0,o.Q3)("",!0)],64)}n(4554),n(9089),n(2762);var ce=n(5183),se="https://leywnjsjihscktddshho.supabase.co",de="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxleXduanNqaWhzY2t0ZGRzaGhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzUzOTgzMjUsImV4cCI6MjA1MDk3NDMyNX0.ovyU0X3DJajnkTyI9oCkV8VchiZaHbZ4igURUOST2Nk",pe={auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},db:{schema:"public"},global:{headers:{"x-my-custom-header":"mapa-application"}}},ve=(0,ce.UU)(se,de,pe);ve.from("places").select("count()",{count:"exact",head:!0}).then((function(e){var t=e.error;t?console.error("Supabase connection error:",t):console.log("Supabase connection successful")}));const me={name:"PlaceDetailsDialog",props:{place:{type:Object,required:!0}},emits:["close","update","delete"],setup:function(e,t){var n=t.emit,a=(0,b.KR)(!1),r=(0,b.KR)(null),l=(0,b.KR)("details"),i=(0,b.KR)(""),u=(0,b.Kh)((0,h.A)({},e.place)),c=(0,b.KR)(null),s=(0,b.KR)(null);(0,o.wB)((function(){return e.place}),(function(e){Object.assign(u,e)}),{deep:!0});var d=function(){var e=(0,g.A)((0,f.A)().mark((function e(){var t,n;return(0,f.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ve.auth.getUser();case 2:t=e.sent,n=t.data.user,c.value=n;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();d();var p=(0,o.EW)((function(){if(!e.place||!c.value)return!1;var t=e.place.user_id===c.value.id,n="your-admin-email@example.com"===c.value.email;return t||n})),v=function(){var t=(0,g.A)((0,f.A)().mark((function t(){var a,o;return(0,f.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(p.value){t.next=3;break}return alert("You do not have permission to delete this place"),t.abrupt("return");case 3:if(!confirm("Are you sure you want to delete this place?")){t.next=19;break}return t.prev=4,t.next=7,ve.from("places")["delete"]().eq("id",e.place.id);case 7:if(a=t.sent,o=a.error,!o){t.next=11;break}throw o;case 11:n("delete",e.place.id),n("close"),t.next=19;break;case 15:t.prev=15,t.t0=t["catch"](4),console.error("Error deleting place:",t.t0),alert("Failed to delete place");case 19:case"end":return t.stop()}}),t,null,[[4,15]])})));return function(){return t.apply(this,arguments)}}(),m=function(e){return e?new Date(e).toLocaleDateString():"Not edited yet"},y=function(t){var a;if(null===(a=e.place)||void 0===a||!a.hasVoted){var o=(0,h.A)({},e.place),l="up"===t?1:-1;o.votes=(o.votes||0)+l,o.hasVoted=!0,r.value=t,n("update",o)}},w=function(){a.value&&n("update",u),a.value=!a.value},A=function(t){var a,o=t.target.files[0];if(o&&((null===(a=e.place)||void 0===a||null===(a=a.images)||void 0===a?void 0:a.length)||0)<3){var r=new FileReader;r.onload=function(t){var a,o=(0,h.A)((0,h.A)({},e.place),{},{images:[].concat((0,k.A)((null===(a=e.place)||void 0===a?void 0:a.images)||[]),[t.target.result])});n("update",o)},r.readAsDataURL(o)}},C=function(t){var a,o=(0,k.A)((null===(a=e.place)||void 0===a?void 0:a.images)||[]);o.splice(t,1),n("update",(0,h.A)((0,h.A)({},e.place),{},{images:o}))},L=function(){var t;if(i.value.trim()){var a={id:Date.now(),text:i.value.trim(),date:(new Date).toLocaleString()},o=(0,h.A)((0,h.A)({},e.place),{},{comments:[].concat((0,k.A)((null===(t=e.place)||void 0===t?void 0:t.comments)||[]),[a])});n("update",o),i.value=""}},E=function(e){s.value=e},x=function(){s.value=null};return{isEditing:a,editedPlace:u,hasVoted:r,activeTab:l,newComment:i,canDelete:p,handleDelete:v,formatDate:m,handleVote:y,toggleEdit:w,handleImageUpload:A,removeImage:C,addComment:L,fullscreenImage:s,showFullscreen:E,closeFullscreen:x}}},fe=(0,I.A)(me,[["render",ue],["__scopeId","data-v-652ef845"]]),ge=fe;var he={class:"user-menu"},ke={key:1,class:"user-info"},be={class:"user-email"};function ye(e,t,n,a,l,i){return(0,o.uX)(),(0,o.CE)("div",he,[n.user?((0,o.uX)(),(0,o.CE)("div",ke,[(0,o.Lk)("span",be,(0,r.v_)(n.user.email),1),(0,o.Lk)("button",{onClick:t[1]||(t[1]=function(t){return e.$emit("logout")}),class:"logout-button"}," Sign Out ")])):((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t[0]||(t[0]=function(t){return e.$emit("login")}),class:"login-button"}," Sign In "))])}const we={name:"UserMenu",props:{user:{type:Object,default:null}},emits:["login","logout"]},Ae=(0,I.A)(we,[["render",ye],["__scopeId","data-v-1e833fe5"]]),Ce=Ae;var Le={class:"auth-modal"};function Ee(e,t,n,r,l,i){return(0,o.uX)(),(0,o.CE)("div",{class:"auth-modal-overlay",onClick:t[2]||(t[2]=(0,a.D$)((function(){return r.handleClose&&r.handleClose.apply(r,arguments)}),["self"]))},[(0,o.Lk)("div",Le,[n.allowClose?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t[0]||(t[0]=function(t){return e.$emit("close")}),class:"close-button"},"√ó")):(0,o.Q3)("",!0),t[3]||(t[3]=(0,o.Lk)("h2",null,"Sign In Required",-1)),t[4]||(t[4]=(0,o.Lk)("p",null,"Please sign in to add and view places",-1)),(0,o.Lk)("button",{onClick:t[1]||(t[1]=function(){return r.handleGoogleSignIn&&r.handleGoogleSignIn.apply(r,arguments)}),class:"google-button"}," Sign in with Google ")])])}var xe={getUser:function(){return(0,g.A)((0,f.A)().mark((function e(){var t,n,a;return(0,f.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ve.auth.getUser();case 3:if(t=e.sent,n=t.data.user,a=t.error,!a){e.next=9;break}return console.error("Error getting user:",a),e.abrupt("return",null);case 9:return e.abrupt("return",n);case 12:return e.prev=12,e.t0=e["catch"](0),console.error("Exception getting user:",e.t0),e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))()},signInWithGoogle:function(){return(0,g.A)((0,f.A)().mark((function e(){var t,n,a;return(0,f.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ve.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}});case 3:if(t=e.sent,n=t.data,a=t.error,!a){e.next=9;break}return console.error("Google sign in error:",a),e.abrupt("return",{data:null,error:a});case 9:return console.log("Sign in successful:",n),e.abrupt("return",{data:n,error:null});case 13:return e.prev=13,e.t0=e["catch"](0),console.error("Exception during Google sign in:",e.t0),e.abrupt("return",{data:null,error:e.t0});case 17:case"end":return e.stop()}}),e,null,[[0,13]])})))()},signOut:function(){return(0,g.A)((0,f.A)().mark((function e(){var t,n;return(0,f.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ve.auth.signOut();case 3:return t=e.sent,n=t.error,n&&console.error("Sign out error:",n),e.abrupt("return",{error:n});case 9:return e.prev=9,e.t0=e["catch"](0),console.error("Exception during sign out:",e.t0),e.abrupt("return",{error:e.t0});case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))()}};const Ie={name:"AuthModal",props:{allowClose:{type:Boolean,default:!1}},emits:["close","auth-success"],setup:function(e,t){var n=t.emit,a=function(){e.allowClose&&n("close")},o=function(){var e=(0,g.A)((0,f.A)().mark((function e(){var t,a,o;return(0,f.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,xe.signInWithGoogle();case 3:if(t=e.sent,a=t.data,o=t.error,!o){e.next=8;break}throw o;case 8:a&&(n("auth-success",a.user),n("close")),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),console.error("Error signing in with Google:",e.t0),alert("Failed to sign in with Google. Please try again.");case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();return{handleGoogleSignIn:o,handleClose:a}}},Me=(0,I.A)(Ie,[["render",Ee],["__scopeId","data-v-e7f6ddfc"]]),_e=Me,Se={name:"App",components:{MapView:X,PlaceDetailsDialog:ge,UserMenu:Ce,AuthModal:_e},setup:function(){var e=(0,b.KR)([]),t=(0,b.KR)(null),n=(0,b.KR)(!1),a=(0,b.KR)(!1),r=(0,b.KR)(null),l=(0,b.KR)(!1),i=(0,o.EW)((function(){return(0,k.A)(e.value).sort((function(e,t){return(t.votes||0)-(e.votes||0)})).map((function(e,t){return(0,h.A)((0,h.A)({},e),{},{rank:t+1})}))})),u=(0,o.EW)((function(){return!(!t.value||!r.value)&&t.value.user_id===r.value.id})),c=function(){var t=(0,g.A)((0,f.A)().mark((function t(){var n;return(0,f.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,console.log("Loading places..."),t.next=4,ve.from("places").select("*").order("created_at",{ascending:!1});case 4:if(n=t.sent,!n.error){t.next=8;break}throw console.error("Supabase error:",n.error),n.error;case 8:if(n.data){t.next=12;break}return console.log("No places found"),e.value=[],t.abrupt("return");case 12:console.log("Places loaded:",n.data),e.value=n.data.map((function(e){return{id:e.id,lat:e.latitude||0,lng:e.longitude||0,name:e.name||"Unnamed Place",description:e.description||"",votes:e.votes||0,images:e.images||[],comments:e.comments||[],hasVoted:e.has_voted||!1,lastEdited:e.last_edited||(new Date).toISOString(),type:e.type||"default",user_id:e.user_id}})),t.next=20;break;case 16:t.prev=16,t.t0=t["catch"](0),console.error("LoadPlaces error:",t.t0),e.value=[];case 20:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(){return t.apply(this,arguments)}}(),s=function(e){r.value=e,l.value=!1},d=function(){var e=(0,g.A)((0,f.A)().mark((function e(){return(0,f.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,xe.signOut();case 2:r.value=null,t.value=null,n.value=!1;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){a.value=!a.value},v=function(e){y(e),a.value=!1},m=function(e){n.value=e},y=function(n){t.value=e.value.find((function(e){return e.id===n}))},w=function(){var a=(0,g.A)((0,f.A)().mark((function a(o){var i,u,c,s,d;return(0,f.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r.value){a.next=3;break}return l.value=!0,a.abrupt("return");case 3:if(!n.value){a.next=27;break}return a.prev=4,console.log("Adding place at:",o),i={name:"New Place",latitude:o.lat,longitude:o.lng,description:"Add description here...",user_id:r.value.id,created_by:r.value.email,votes:0,images:[],comments:[],type:"default"},a.next=9,ve.from("places").insert([i]).select("*").single();case 9:if(u=a.sent,c=u.data,s=u.error,!s){a.next=16;break}return console.error("Supabase error:",s),alert("Failed to add place. Please try again."),a.abrupt("return");case 16:console.log("Place added successfully:",c),d={id:c.id,lat:c.latitude,lng:c.longitude,name:c.name,description:c.description,votes:0,images:[],comments:[],lastEdited:c.last_edited,type:c.type||"default"},e.value.push(d),t.value=d,n.value=!1,a.next=27;break;case 23:a.prev=23,a.t0=a["catch"](4),console.error("Error details:",a.t0),alert("Failed to add place. Please try again.");case 27:case"end":return a.stop()}}),a,null,[[4,23]])})));return function(e){return a.apply(this,arguments)}}(),A=function(){var n=(0,g.A)((0,f.A)().mark((function n(a){var o,r,l,i;return(0,f.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,ve.from("places").update({name:a.name,description:a.description,votes:a.votes,images:a.images,comments:a.comments,has_voted:a.hasVoted,last_edited:new Date}).eq("id",a.id);case 3:if(o=n.sent,r=o.error,!r){n.next=7;break}throw r;case 7:l=e.value.findIndex((function(e){return e.id===a.id})),-1!==l&&(e.value[l]=(0,h.A)((0,h.A)({},a),{},{lastEdited:(new Date).toLocaleString()}),(null===(i=t.value)||void 0===i?void 0:i.id)===a.id&&(t.value=e.value[l])),n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](0),console.error("Error updating place:",n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e){return n.apply(this,arguments)}}(),C=function(e){alert(e)},L=function(){var n=(0,g.A)((0,f.A)().mark((function n(a){return(0,f.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.value=e.value.filter((function(e){return e.id!==a})),t.value=null;case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,o.sV)((0,g.A)((0,f.A)().mark((function e(){var n;return(0,f.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,xe.getUser();case 3:return n=e.sent,r.value=n,n||(l.value=!0),e.next=8,c();case 8:ve.auth.onAuthStateChange((function(e,n){r.value=(null===n||void 0===n?void 0:n.user)||null,null!==n&&void 0!==n&&n.user||(l.value=!0,t.value=null)})),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),console.error("Setup error:",e.t0),l.value=!0;case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))),(0,o.wB)((function(){return r.value}),(function(e){e||(l.value=!0)})),{markers:e,selectedMarker:t,isAddingMode:n,showRanking:a,user:r,showAuthModal:l,sortedPlaces:i,canDeletePlace:u,handleAuthSuccess:s,handleLogout:d,toggleRanking:p,selectAndCloseRanking:v,selectMarker:y,handleMapClick:w,toggleAddMode:m,updatePlace:A,handleLocationError:C,closeDialog:function(){return t.value=null},handleDelete:L}}},De=(0,I.A)(Se,[["render",m],["__scopeId","data-v-31264f15"]]),Oe=De;(0,a.Ef)(Oe).mount("#app")}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,n),r.exports}n.m=e,(()=>{var e=[];n.O=(t,a,o,r)=>{if(!a){var l=1/0;for(s=0;s<e.length;s++){for(var[a,o,r]=e[s],i=!0,u=0;u<a.length;u++)(!1&r||l>=r)&&Object.keys(n.O).every((e=>n.O[e](a[u])))?a.splice(u--,1):(i=!1,r<l&&(l=r));if(i){e.splice(s--,1);var c=o();void 0!==c&&(t=c)}}return t}r=r||0;for(var s=e.length;s>0&&e[s-1][2]>r;s--)e[s]=e[s-1];e[s]=[a,o,r]}})(),(()=>{n.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return n.d(t,{a:t}),t}})(),(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(a,o){if(1&o&&(a=this(a)),8&o)return a;if("object"===typeof a&&a){if(4&o&&a.__esModule)return a;if(16&o&&"function"===typeof a.then)return a}var r=Object.create(null);n.r(r);var l={};e=e||[null,t({}),t([]),t(t)];for(var i=2&o&&a;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((e=>l[e]=()=>a[e]));return l["default"]=()=>a,n.d(r,l),r}})(),(()=>{n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}})(),(()=>{n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,a)=>(n.f[a](e,t),t)),[]))})(),(()=>{n.u=e=>"js/"+e+".7c8e4d5a.js"})(),(()=>{n.miniCssF=e=>{}})(),(()=>{n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="mapa-frontend:";n.l=(a,o,r,l)=>{if(e[a])e[a].push(o);else{var i,u;if(void 0!==r)for(var c=document.getElementsByTagName("script"),s=0;s<c.length;s++){var d=c[s];if(d.getAttribute("src")==a||d.getAttribute("data-webpack")==t+r){i=d;break}}i||(u=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,n.nc&&i.setAttribute("nonce",n.nc),i.setAttribute("data-webpack",t+r),i.src=a),e[a]=[o];var p=(t,n)=>{i.onerror=i.onload=null,clearTimeout(v);var o=e[a];if(delete e[a],i.parentNode&&i.parentNode.removeChild(i),o&&o.forEach((e=>e(n))),t)return t(n)},v=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),u&&document.head.appendChild(i)}}})(),(()=>{n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{n.p="/"})(),(()=>{var e={524:0};n.f.j=(t,a)=>{var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)a.push(o[2]);else{var r=new Promise(((n,a)=>o=e[t]=[n,a]));a.push(o[2]=r);var l=n.p+n.u(t),i=new Error,u=a=>{if(n.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var r=a&&("load"===a.type?"missing":a.type),l=a&&a.target&&a.target.src;i.message="Loading chunk "+t+" failed.\n("+r+": "+l+")",i.name="ChunkLoadError",i.type=r,i.request=l,o[1](i)}};n.l(l,u,"chunk-"+t,t)}},n.O.j=t=>0===e[t];var t=(t,a)=>{var o,r,[l,i,u]=a,c=0;if(l.some((t=>0!==e[t]))){for(o in i)n.o(i,o)&&(n.m[o]=i[o]);if(u)var s=u(n)}for(t&&t(a);c<l.length;c++)r=l[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(s)},a=self["webpackChunkmapa_frontend"]=self["webpackChunkmapa_frontend"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=n.O(void 0,[504],(()=>n(3183)));a=n.O(a)})();
//# sourceMappingURL=app.90330b9b.js.map